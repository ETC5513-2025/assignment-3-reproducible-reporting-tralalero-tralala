---
title: "ETC5513-Assignment3"
format: pdf
editor: visual
---

```{r}
library(tidyverse)
epl_raw <- read.csv("data/epl_final.csv")
epl_data <- epl_raw %>%
  select(
    Season,
    HomeTeam, AwayTeam,
    FullTimeHomeGoals, FullTimeAwayGoals,
    FullTimeResult,
    HomeShots, AwayShots
  )

```


## Executive Summary


## Introduction


## Methodology 
```{r}
library(kableExtra)
# Show head of raw data
epl_data %>%
  head(5) %>%
  kable(caption = "First 5 rows of the EPL processed dataset")
```

shots over time
```{r}
epl_processed_method <- epl_data %>%
  mutate(
    TotalGoals = FullTimeHomeGoals + FullTimeAwayGoals,
    TotalShots = HomeShots + AwayShots
  )

# Step 1: Summarise average shots per match by season
summary_by_season <- epl_processed_method %>%
  group_by(Season) %>%
  summarise(
    AvgShotsPerMatch = mean(TotalShots, na.rm = TRUE)
  ) %>%
  ungroup()

# Step 2: Plot
ggplot(summary_by_season, aes(x = Season, y = AvgShotsPerMatch, group = 1)) +
  geom_line(color = "#0072B2", size = 1.2) +
  geom_point(color = "#0072B2", size = 2) +
  labs(
    title = "Average Shots per Match in the EPL Over Time",
    x = "Season",
    y = "Average Shots per Match"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```


code prep for analysis
```{r}
recent_seasons <- c("2019/20", "2020/21", "2021/22", "2022/23", "2023/24", "2024/25")
# Filter to only include most recent seasons
epl_recent <- epl_data %>%
  filter(Season %in% recent_seasons)

# Get stats for home games
home_stats <- epl_recent %>%
  mutate(
    Team = HomeTeam,
    Shots = HomeShots,
    Win = ifelse(FullTimeResult == "H", 1, 0)
  ) %>%
  select(Season, Team, Shots, Win)

# Get stats for away games
away_stats <- epl_recent %>%
  mutate(
    Team = AwayTeam,
    Shots = AwayShots,
    Win = ifelse(FullTimeResult == "A", 1, 0)
  ) %>%
  select(Season, Team, Shots, Win)

# Combine datasets for home and away stats
team_match_data <- bind_rows(home_stats, away_stats)

team_season_summary <- team_match_data %>%
  group_by(Season, Team) %>%
  summarise(
    TotalMatches = n(),
    TotalShots = sum(Shots, na.rm = TRUE),
    TotalWins = sum(Win, na.rm = TRUE),
    AvgShotsPerGame = TotalShots / TotalMatches,
    WinRatePercent = 100 * TotalWins / TotalMatches
  ) %>%
  ungroup()
```

## Results


## Discussion,Conclusion & Recommendatinos


## References