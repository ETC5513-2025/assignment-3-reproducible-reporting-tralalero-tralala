---
title: "ETC5513-Assignment3"
format: pdf
editor: visual
---

```{r}
library(tidyverse)
epl_raw <- read.csv("data/epl_final.csv")
epl_data <- epl_raw %>%
  select(
    Season,
    HomeTeam, AwayTeam,
    FullTimeHomeGoals, FullTimeAwayGoals,
    FullTimeResult,
    HomeShots, AwayShots
  )

```

## Executive Summary

## Introduction

## Methodology

### Dataset Introduction

```{r}
# Create variable for total number of shots each game
epl_processed_method <- epl_data %>%
  mutate(TotalShots = HomeShots + AwayShots)

# Summarise average shots per match by season
summary_by_season <- epl_processed_method %>%
  group_by(Season) %>%
  summarise(AvgShotsPerMatch = mean(TotalShots, na.rm = TRUE))

# Create line plot of total shots per game
ggplot(summary_by_season, aes(x = Season, y = AvgShotsPerMatch, group = 1)) +
  geom_line() +
  labs(x = "Season",
       y = "Average Shots per Match") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

As illustrated in **Figure 1** above, there has been a noticeable increase in the average number of shots taken by a team during an English Premier League (EPL) match over the past two decades. This trend indicates a potential shift in playstyle across the league, from traditionally balanced or defensive approaches to more aggressive, attack-oriented strategies. This study aims to determine whether adopting a more offense-oriented approach leads to improved team performance in the EPL.

To explore this question, we use match-level data sourced from [Kaggle](https://www.kaggle.com/datasets/marcohuiii/english-premier-league-epl-match-data-2000-2025/data), covering EPL seasons from 2000/01 through 2024/25. From this dataset, we extracted key variables relevant to offensive output and team performance: `Season`, `HomeTeam`, `AwayTeam`, `FullTimeHomeGoals`, `FullTimeAwayGoals`, `FullTimeResult`, `HomeShots`, and `AwayShots` and 

### Dataset Description

The core of the analysis focuses on the most recent five seasons. For each team and season, we compute two summary metrics:

1.  **Average Shots Per Game** = Total Shots / Total Matches
2.  **Win Rate (%)** = (Total Wins / Total Matches) Ã— 100

These variables allow us to measure offensive intensity and performance respectively. A scatterplot of Win Rate against Average Shots Per Game is used to visualize whether more aggressive teams consistently outperform less aggressive ones in terms of match outcomes.

Average shots per game is chosen as a proxy for offensive aggression, as it directly captures attacking intent regardless of actual goal conversion. Win rate is used to reflect season-level success, providing a consistent performance benchmark across teams and seasons.

```{r}
library(kableExtra)
# Show head of raw data
epl_data %>%
  head(5) %>%
  kable(caption = "First 5 rows of the EPL processed dataset")
```

shots over time

code prep for analysis

```{r}
recent_seasons <- c("2019/20", "2020/21", "2021/22", "2022/23", "2023/24", "2024/25")
# Filter to only include most recent seasons
epl_recent <- epl_data %>%
  filter(Season %in% recent_seasons)

# Get stats for home games
home_stats <- epl_recent %>%
  mutate(
    Team = HomeTeam,
    Shots = HomeShots,
    Win = ifelse(FullTimeResult == "H", 1, 0)
  ) %>%
  select(Season, Team, Shots, Win)

# Get stats for away games
away_stats <- epl_recent %>%
  mutate(
    Team = AwayTeam,
    Shots = AwayShots,
    Win = ifelse(FullTimeResult == "A", 1, 0)
  ) %>%
  select(Season, Team, Shots, Win)

# Combine datasets for home and away stats
team_match_data <- bind_rows(home_stats, away_stats)

team_season_summary <- team_match_data %>%
  group_by(Season, Team) %>%
  summarise(
    TotalMatches = n(),
    TotalShots = sum(Shots, na.rm = TRUE),
    TotalWins = sum(Win, na.rm = TRUE),
    AvgShotsPerGame = TotalShots / TotalMatches,
    WinRatePercent = 100 * TotalWins / TotalMatches
  ) %>%
  ungroup()
```

## Results

## Discussion,Conclusion & Recommendatinos

## References
